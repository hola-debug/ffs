{
  "name": "AI Transactions (text & voice) - POCKETS",
  "nodes": [
    {
      "parameters": {
        "tableId": "movements",
        "fieldsUi": {
          "fieldValues": [
            {
              "fieldId": "user_id",
              "fieldValue": "={{ $json.output.parseJson().user_id }}"
            },
            {
              "fieldId": "account_id",
              "fieldValue": "={{ $json.output.parseJson().account_id }}"
            },
            {
              "fieldId": "category_id",
              "fieldValue": "={{ $json.output.parseJson().category_id }}"
            },
            {
              "fieldId": "pocket_id",
              "fieldValue": "={{ $json.output.parseJson().pocket_id }}"
            },
            {
              "fieldId": "type",
              "fieldValue": "={{ $json.output.parseJson().type }}"
            },
            {
              "fieldId": "amount",
              "fieldValue": "={{ $json.output.parseJson().amount }}"
            },
            {
              "fieldId": "currency",
              "fieldValue": "={{ $json.output.parseJson().currency }}"
            },
            {
              "fieldId": "date",
              "fieldValue": "={{ $json.output.parseJson().date }}"
            },
            {
              "fieldId": "description",
              "fieldValue": "={{ $json.output.parseJson().description }}"
            },
            {
              "fieldId": "metadata",
              "fieldValue": "={{ $json.output.parseJson().metadata }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        -1776,
        -336
      ],
      "id": "6d66aab6-0bcf-4459-8bdd-e56b2ed28423",
      "name": "Create Movement",
      "credentials": {
        "supabaseApi": {
          "id": "DTm1mUTSfKIqIIwV",
          "name": "Supabase FFS"
        }
      }
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        -3840,
        -352
      ],
      "id": "02ab75ff-7cca-4db6-b6a8-96126bb1bfc9",
      "name": "Merge"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4o-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -2240,
        -464
      ],
      "id": "a3d3f9f8-8b75-4edb-8305-f8c59aeaf8a9",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "3mbChNvYu3kRSO2W",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "resource": "audio",
        "operation": "transcribe",
        "binaryPropertyName": "={{ $('Webhook').item.binary.audio }}",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        -4112,
        -240
      ],
      "id": "c7afd1ec-7e9d-4d6a-a8a2-8d7dda0f5d66",
      "name": "Transcribe Recording",
      "credentials": {
        "openAiApi": {
          "id": "3mbChNvYu3kRSO2W",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "e1f5aa2c-d785-4f74-a6b4-0e1825c504c0",
                    "leftValue": "={{ $json.body.type }}",
                    "rightValue": "text",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "texto"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "f419b6c9-fe67-4311-b6e7-0825ae81153f",
                    "leftValue": "={{ $json.body.type }}",
                    "rightValue": "voice",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Audio"
            }
          ]
        },
        "options": {
          "fallbackOutput": "extra"
        }
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -4336,
        -368
      ],
      "id": "3a65ce90-5df2-4697-a4d9-f8dd98da39e5",
      "name": "Switch1"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "68b19a15-83e9-4153-842f-e700074273f0",
              "name": "body.type",
              "value": "={{ $json.body.type }}",
              "type": "string"
            },
            {
              "id": "2fac7abf-cff9-409e-a02b-65e99d7c6778",
              "name": "body.userId",
              "value": "={{ $json.body.userId }}",
              "type": "string"
            },
            {
              "id": "d965357c-6cff-4f34-b419-5bd5e1c24255",
              "name": "body.message",
              "value": "={{ $json.body.message }}",
              "type": "string"
            },
            {
              "id": "31902c74-e7fc-44ff-b4c6-a605209b2530",
              "name": "audio",
              "value": "=$binary.audio",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -4592,
        -352
      ],
      "id": "e61606b7-a363-425e-98d1-cc7fb30bd9d7",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "9d14f317-70b7-4f91-9272-7794e92a7dda",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -4752,
        -336
      ],
      "id": "753ee19d-63a5-475e-b0ff-6d01acaaae67",
      "name": "Webhook",
      "webhookId": "9d14f317-70b7-4f91-9272-7794e92a7dda"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Eres un asistente financiero que convierte lenguaje natural en un objeto JSON para insertar en la tabla `movements`.\n\n## ðŸŽ¯ CONTEXTO ACTUAL DEL USUARIO\n\n**user_id:** {{ $('Edit Fields').first().json.body.userId }}\n**mensaje:** {{ $('Edit Fields').first().json.body.message }}, {{ $('Merge').first().json.text }}\n**fecha actual:** {{ $now }}\n**ingreso mensual:** {{ $json.monthly_income }} {{ $json.currency }}\n**disponible sin asignar:** {{ $json.available_balance }} {{ $json.currency }}\n\n**Cuentas disponibles:** {{ JSON.stringify($json.accounts) }}\n  // [{ id, name, balance, currency }]\n\n**CategorÃ­as disponibles:** {{ JSON.stringify($json.categories) }}\n  // [{ id, name, type }]\n  // tipos: income | fixed_expense | saving | pocket_expense\n\n**Bolsas activas (POCKETS):**\n{{ JSON.stringify($json.pockets) }}\n  // [{ id, name, type, current_balance, daily_allowance/target_amount }]\n  // type: 'expense' (bolsa de gasto) o 'saving' (bolsa de ahorro)\n\n---\n\n## ðŸ“‹ ESQUEMA DE `movements`\n\n```json\n{\n  \"user_id\": \"UUID\",\n  \"type\": \"income | fixed_expense | saving_deposit | pocket_allocation | pocket_expense | pocket_return\",\n  \"amount\": \"nÃºmero > 0\",\n  \"currency\": \"UYU\",\n  \"date\": \"YYYY-MM-DD\",\n  \"description\": \"texto descriptivo\",\n  \"account_id\": \"UUID | null\",\n  \"category_id\": \"UUID | null\",\n  \"pocket_id\": \"UUID | null (requerido si type es pocket_*)\",\n  \"metadata\": {\n    \"probability\": 0.95,\n    \"keywords\": [\"array\", \"de\", \"palabras\"],\n    \"chosen_account_name\": \"nombre\",\n    \"chosen_category_name\": \"nombre\",\n    \"chosen_pocket_name\": \"nombre\",\n    \"ai_interpretation\": \"breve explicaciÃ³n\"\n  }\n}\n```\n\n---\n\n## ðŸŽ¯ TIPOS DE MOVIMIENTOS\n\n1. **income** - Ingreso mensual (salario, freelance)\n2. **fixed_expense** - Gasto fijo mensual (alquiler, servicios)\n3. **saving_deposit** - Ahorro directo (fondo de emergencia)\n4. **pocket_allocation** - Asignar dinero a una bolsa\n5. **pocket_expense** - Gasto desde una bolsa (USAR ESTE PARA GASTOS NORMALES)\n6. **pocket_return** - DevoluciÃ³n de bolsa (raro, generalmente automÃ¡tico)\n\n---\n\n## âš¡ REGLAS DE INTERPRETACIÃ“N\n\n### Para GASTOS NORMALES (lo mÃ¡s comÃºn):\n- Si el usuario dice \"gastÃ© $X en Y\", \"comprÃ© X\", \"paguÃ© Y\":\n  - **type:** `pocket_expense`\n  - **pocket_id:** Elegir la bolsa mÃ¡s adecuada segÃºn el concepto\n  - **category_id:** Elegir de tipo `pocket_expense`\n  - **amount:** el monto mencionado\n  - **description:** resumen del gasto\n\n### Para GASTOS FIJOS:\n- Si menciona \"alquiler\", \"servicios\", \"internet\", \"subscripciÃ³n\":\n  - **type:** `fixed_expense`\n  - **pocket_id:** null\n  - **category_id:** de tipo `fixed_expense`\n\n### Para AHORROS:\n- Si dice \"ahorrÃ©\", \"guardÃ© para emergencias\":\n  - **type:** `saving_deposit`\n  - **pocket_id:** null\n  - **category_id:** de tipo `saving`\n\n### Para CREAR/ASIGNAR BOLSAS:\n- Si dice \"crear bolsa de $X\", \"separar $Y para Z\":\n  - **type:** `pocket_allocation`\n  - **pocket_id:** de la bolsa mencionada\n  - **category_id:** null\n\n---\n\n## ðŸŽ’ ELECCIÃ“N DE BOLSA (POCKET)\n\nCuando el movimiento es `pocket_expense`, DEBES elegir la bolsa correcta:\n\n- **Comida/Supermercado/Restaurante** â†’ Bolsa de \"Comida\" o similar\n- **Transporte/Uber/Nafta** â†’ Bolsa de \"Transporte\"\n- **Entretenimiento/Salidas/Cine** â†’ Bolsa de \"Entretenimiento\" o \"Salidas\"\n- Si no hay bolsa adecuada y es gasto random â†’ Bolsa con mayor saldo\n- Si no hay ninguna bolsa â†’ pocket_id=null y explica en metadata\n\n---\n\n## ðŸ’¡ EJEMPLOS\n\n### Ejemplo 1: \"gastÃ© 500 en el super\"\n```json\n{\n  \"user_id\": \"...\",\n  \"type\": \"pocket_expense\",\n  \"amount\": 500,\n  \"currency\": \"UYU\",\n  \"date\": \"2025-01-12\",\n  \"description\": \"Compra en supermercado\",\n  \"account_id\": \"id_cuenta_efectivo\",\n  \"category_id\": \"id_categoria_comida\",\n  \"pocket_id\": \"id_bolsa_comida\",\n  \"metadata\": {\n    \"probability\": 0.95,\n    \"keywords\": [\"super\", \"comida\"],\n    \"chosen_pocket_name\": \"Comida Quincenal\",\n    \"ai_interpretation\": \"Gasto de supermercado desde bolsa de comida\"\n  }\n}\n```\n\n### Ejemplo 2: \"paguÃ© el alquiler 15000\"\n```json\n{\n  \"user_id\": \"...\",\n  \"type\": \"fixed_expense\",\n  \"amount\": 15000,\n  \"currency\": \"UYU\",\n  \"date\": \"2025-01-12\",\n  \"description\": \"Pago de alquiler\",\n  \"account_id\": \"id_cuenta\",\n  \"category_id\": \"id_categoria_alquiler\",\n  \"pocket_id\": null,\n  \"metadata\": {\n    \"probability\": 1.0,\n    \"keywords\": [\"alquiler\", \"gasto fijo\"],\n    \"ai_interpretation\": \"Gasto fijo mensual de alquiler\"\n  }\n}\n```\n\n---\n\n## âœ… SALIDA REQUERIDA\n\n- Devuelve SOLO un objeto JSON vÃ¡lido\n- SIN bloques de cÃ³digo markdown (```)\n- SIN texto adicional antes o despuÃ©s\n- Campos obligatorios: user_id, type, amount, date\n- Si no encuentras cuenta/categorÃ­a/bolsa adecuada, usa null y explica en metadata",
        "options": {
          "systemMessage": "=ActÃºas como un asistente financiero especializado en el sistema de BOLSAS DE DINERO.\n\n## ðŸŽ’ CONCEPTO CLAVE: BOLSAS (POCKETS)\n\nLas BOLSAS son separaciones del ingreso disponible:\n\n**Bolsas de GASTO (type='expense'):**\n- El usuario separa $X para gastar en Y dÃ­as\n- Tiene un `daily_allowance` (cuÃ¡nto puede gastar por dÃ­a)\n- Ejemplo: \"Comida Quincenal\" con $8000 por 15 dÃ­as\n\n**Bolsas de AHORRO (type='saving'):**\n- El usuario separa dinero para un objetivo\n- Tiene un `target_amount` (meta a alcanzar)\n- Ejemplo: \"Viaje\" con meta de $15000\n\n## âš¡ TU MISIÃ“N\n\n1. Analizar el mensaje del usuario\n2. Identificar si es un GASTO NORMAL (lo mÃ¡s comÃºn)\n3. Para gastos normales, elegir la BOLSA correcta\n4. Elegir cuenta y categorÃ­a adecuadas\n5. Devolver JSON limpio para la tabla `movements`\n\n## ðŸš¨ REGLAS CRÃTICAS\n\n1. **La mayorÃ­a de los gastos son `pocket_expense`** (gasto desde bolsa)\n2. **DEBES elegir la bolsa correcta** usando el contexto de pockets disponibles\n3. **Usa `fixed_expense` solo para gastos fijos** (alquiler, servicios)\n4. **Usa `saving_deposit` solo para ahorros directos**\n5. **NUNCA uses `pocket_allocation`** a menos que el usuario diga explÃ­citamente \"crear bolsa\" o \"asignar a bolsa\"\n6. **Si no hay bolsa adecuada**, usa pocket_id=null y explica en metadata\n7. **Devuelve SOLO el JSON**, sin texto adicional ni markdown\n\n## ðŸŽ¯ FLUJO TÃPICO\n\nUsuario dice: \"gastÃ© $500 en comida\"\nâ†“\n1. Es un gasto â†’ `pocket_expense`\n2. Â¿Hay bolsa de comida? â†’ SÃ­: \"Comida Quincenal\"\n3. pocket_id = id de esa bolsa\n4. category_id = categorÃ­a de tipo \"pocket_expense\" relacionada con comida\n5. Devolver JSON\n\n## âœ… FORMATO FINAL\n\nDevuelve exclusivamente:\n```\n{\"user_id\":\"...\",\"type\":\"pocket_expense\",\"amount\":500,...}\n```\n\nSIN ```json, SIN explicaciones, SIN texto adicional."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        -2368,
        -80
      ],
      "id": "0dfa6f7c-3757-4ca6-b816-68eec7616eea",
      "name": "Clasificar Movimiento"
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "createCategory(user_id, name, type) â†’ Crea una categorÃ­a nueva (type âˆˆ income|fixed_expense|saving|pocket_expense) y devuelve la fila completa.",
        "tableId": "categories",
        "fieldsUi": {
          "fieldValues": [
            {
              "fieldId": "user_id",
              "fieldValue": "={{ $('Merge').first().json.body.userId }}"
            },
            {
              "fieldId": "name",
              "fieldValue": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('fieldValues1_Field_Value', ``, 'string') }}"
            },
            {
              "fieldId": "type",
              "fieldValue": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('fieldValues2_Field_Value', `el campo type estÃ¡ restringido a: income, fixed_expense, saving, pocket_expense`, 'string') }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabaseTool",
      "typeVersion": 1,
      "position": [
        -2032,
        240
      ],
      "id": "f3098c4d-ac40-4625-82ad-455e7e868357",
      "name": "Create Category Tool",
      "credentials": {
        "supabaseApi": {
          "id": "DTm1mUTSfKIqIIwV",
          "name": "Supabase FFS"
        }
      }
    },
    {
      "parameters": {
        "operation": "getAll",
        "tableId": "categories",
        "returnAll": true,
        "filters": {
          "conditions": [
            {
              "keyName": "user_id",
              "condition": "eq",
              "keyValue": "={{ $('Edit Fields').item.json.body.userId }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        -3232,
        -352
      ],
      "id": "7a1f1856-0b5e-4e0e-9365-42dfab04e7fa",
      "name": "Get Categories",
      "credentials": {
        "supabaseApi": {
          "id": "DTm1mUTSfKIqIIwV",
          "name": "Supabase FFS"
        }
      }
    },
    {
      "parameters": {
        "operation": "getAll",
        "tableId": "accounts",
        "returnAll": true,
        "filterType": "none"
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        -3024,
        -352
      ],
      "id": "934ebb14-5e98-4d01-bccb-061d61fbc839",
      "name": "Get Accounts",
      "credentials": {
        "supabaseApi": {
          "id": "DTm1mUTSfKIqIIwV",
          "name": "Supabase FFS"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Obtener datos del nodo \"Get Accounts\" (que viene del merge con Edit Fields)\nconst mergeData = $input.all()[0].json;\n\n// Obtener cuentas con balance\nconst accounts = $('Get Accounts').all()\n  .map(i => i.json)\n  .filter(a => a.id && a.name)\n  .map(a => ({ \n    id: a.id, \n    name: a.name, \n    balance: a.balance,\n    currency: a.currency \n  }));\n\n// Obtener categorÃ­as con tipo\nconst categories = $('Get Categories').all()\n  .map(i => i.json)\n  .filter(c => c.id && c.name)\n  .map(c => ({ \n    id: c.id, \n    name: c.name,\n    type: c.type\n  }));\n\n// Obtener bolsas activas con informaciÃ³n relevante\nconst pockets = $('Get Active Pockets').all()\n  .map(i => i.json)\n  .filter(p => p.id && p.name && p.status === 'active')\n  .map(p => ({ \n    id: p.id, \n    name: p.name,\n    type: p.type,\n    current_balance: p.current_balance,\n    daily_allowance: p.daily_allowance,\n    target_amount: p.target_amount,\n    days_remaining: p.days_remaining\n  }));\n\n// Obtener resumen mensual\nconst summaryItems = $('Get Monthly Summary').all();\nconst summary = summaryItems.length > 0 ? summaryItems[0].json : {};\n\n// Eliminar duplicados\nconst uniqById = arr => Array.from(new Map(arr.map(i => [i.id, i])).values());\n\n// Devolver contexto completo para el agente\nreturn {\n  json: {\n    accounts: uniqById(accounts),\n    categories: uniqById(categories),\n    pockets: uniqById(pockets),\n    monthly_income: summary.monthly_income || 0,\n    available_balance: summary.available_balance || 0,\n    currency: summary.currency || 'UYU'\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -2816,
        -352
      ],
      "id": "70a43cd8-ca23-4404-9892-d1a9105cfe88",
      "name": "Build Context"
    },
    {
      "parameters": {
        "operation": "getAll",
        "tableId": "pockets",
        "returnAll": true,
        "filters": {
          "conditions": [
            {
              "keyName": "user_id",
              "condition": "eq",
              "keyValue": "={{ $('Edit Fields').item.json.body.userId }}"
            },
            {
              "keyName": "status",
              "condition": "eq",
              "keyValue": "active"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        -3472,
        -352
      ],
      "id": "32f16555-3750-4888-8b6b-3f284eed73dc",
      "name": "Get Active Pockets",
      "credentials": {
        "supabaseApi": {
          "id": "DTm1mUTSfKIqIIwV",
          "name": "Supabase FFS"
        }
      }
    },
    {
      "parameters": {
        "operation": "getAll",
        "tableId": "user_monthly_summary",
        "limit": 1,
        "filters": {
          "conditions": [
            {
              "keyName": "user_id",
              "condition": "eq",
              "keyValue": "={{ $('Edit Fields').item.json.body.userId }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        -3680,
        -176
      ],
      "id": "dd7274cf-b022-439a-8880-24e6d11a0329",
      "name": "Get Monthly Summary",
      "credentials": {
        "supabaseApi": {
          "id": "DTm1mUTSfKIqIIwV",
          "name": "Supabase FFS"
        }
      }
    }
  ],
  "pinData": {
    "Webhook": [
      {
        "json": {
          "headers": {
            "host": "centro-n8n.xqnwvv.easypanel.host",
            "user-agent": "Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Mobile Safari/537.36",
            "content-length": "216",
            "accept": "*/*",
            "accept-encoding": "gzip, deflate, br, zstd",
            "accept-language": "en-US,en;q=0.9,es;q=0.8",
            "content-type": "application/json",
            "origin": "http://localhost:5173",
            "priority": "u=1, i",
            "referer": "http://localhost:5173/",
            "sec-ch-ua": "\"Google Chrome\";v=\"135\", \"Not-A.Brand\";v=\"8\", \"Chromium\";v=\"135\"",
            "sec-ch-ua-mobile": "?1",
            "sec-ch-ua-platform": "\"Android\"",
            "sec-fetch-dest": "empty",
            "sec-fetch-mode": "cors",
            "sec-fetch-site": "cross-site",
            "x-forwarded-for": "167.56.135.38",
            "x-forwarded-host": "centro-n8n.xqnwvv.easypanel.host",
            "x-forwarded-port": "443",
            "x-forwarded-proto": "https",
            "x-forwarded-server": "93d58826bca7",
            "x-real-ip": "167.56.135.38"
          },
          "params": {},
          "query": {},
          "body": {
            "message": "agrega 20 a gastos de comida",
            "userId": "f9dfd367-8afd-4bcf-859b-0981bc8d298c",
            "type": "text",
            "sessionId": "session-f9dfd367-8afd-4bcf-859b-0981bc8d298c-1762979962185",
            "timestamp": "2025-11-12T20:39:22.185Z"
          },
          "webhookUrl": "https://centro-n8n.xqnwvv.easypanel.host/webhook/9d14f317-70b7-4f91-9272-7794e92a7dda",
          "executionMode": "production"
        }
      }
    ]
  },
  "connections": {
    "Merge": {
      "main": [
        [
          {
            "node": "Get Monthly Summary",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Clasificar Movimiento",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Transcribe Recording": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Switch1": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Transcribe Recording",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Switch1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create Category Tool": {
      "ai_tool": [
        [
          {
            "node": "Clasificar Movimiento",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Clasificar Movimiento": {
      "main": [
        [
          {
            "node": "Create Movement",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Categories": {
      "main": [
        [
          {
            "node": "Get Accounts",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Accounts": {
      "main": [
        [
          {
            "node": "Build Context",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Build Context": {
      "main": [
        [
          {
            "node": "Clasificar Movimiento",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Active Pockets": {
      "main": [
        [
          {
            "node": "Get Categories",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Monthly Summary": {
      "main": [
        [
          {
            "node": "Get Active Pockets",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1",
    "timezone": "America/Argentina/Buenos_Aires",
    "callerPolicy": "workflowsFromSameOwner",
    "availableInMCP": false
  },
  "versionId": "157352a4-1bbb-4264-af6c-2bcd6ee4a013",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "f9970caab00256920bdb049a5ae2998c33406f33dca00798d3ac5e92c2009533"
  },
  "id": "vFcoho0lOQOjt9w2",
  "tags": []
}